{% load thumbnail %}
{% load i18n %}
{% load staticfiles %}
{% load oembed_tags %}

{% with all_media=product.get_media %}

{% if all_media|length = 0 %}
<div id="product_gallery">
    <div class="carousel">
        <div>
            <img src="{{ STATIC_URL }}shop/img/noimage.jpg"/>
        </div>
    </div>
</div>

{% else %}

{% if all_media|length > 0 %}

<div id="product_gallery">
    <div class="carousel">
        {% for url in all_media %}
            {{ url|oembed:"600x600" }}
        {% endfor %}
    </div>
</div>
{% else %}


{% endif %}
{% endif %}


<script type="text/javascript">
    $(document).ready(function () {
        /*
         */
        $('.carousel').slick({
            dots: true,
            infinite: false,
            speed: 300,
            slidesToShow: 4,
            slidesToScroll: 4,
            responsive: [
                {
                    breakpoint: 1024,
                    settings: {
                        slidesToShow: 3,
                        slidesToScroll: 3,
                        infinite: true,
                        dots: true
                    }
                },
                {
                    breakpoint: 600,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 2,
                        dots: true
                    }
                },
                {
                    breakpoint: 480,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true
                    }
                }
            ]

        });
    });
</script>
{% endwith %}

{% comment %}
{% with all_media=product.get_media %}
{# use length rather then count as the images get queried anyways #}

{% if all_media|length = 0 %}
<div id="product_gallery">
    <div class="carousel">
        <div>
            <img src="{{ STATIC_URL }}shop/img/noimage.jpg"/>
        </div>
    </div>
</div>

{% else %}

{% if all_images|length > 1 %}

<div id="product_gallery">
    <div class="carousel">
        {% for image in all_images %}
        <div>
            {% thumbnail image.original "440x400" upscale=False as thumb %}
            <img src="{{ thumb.url }}" alt="{{ product.get_title }}"/>
            {% endthumbnail %}
        </div>
        {% endfor %}
    </div>
</div>
{% else %}

{# Only one image to show #}
<div id="product_gallery">
    <div class="carousel">
        <div>
            {% with image=product.primary_image %}
            {% thumbnail image.original "440x400" upscale=False as thumb %}
            <img src="{{ thumb.url }}" alt="{{ product.get_title }}"/>
            {% endthumbnail %}
            {% endwith %}
        </div>
    </div>
</div>

{% endif %}
{% endif %}


<script type="text/javascript">
    $(document).ready(function () {
        /*
         */
        $('.carousel').slick({
            dots: true,
            infinite: false,
            speed: 300,
            slidesToShow: 4,
            slidesToScroll: 4,
            responsive: [
                {
                    breakpoint: 1024,
                    settings: {
                        slidesToShow: 3,
                        slidesToScroll: 3,
                        infinite: true,
                        dots: true
                    }
                },
                {
                    breakpoint: 600,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 2,
                        dots: true
                    }
                },
                {
                    breakpoint: 480,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        dots: true
                    }
                }
            ]

        });
    });
</script>
{% endwith %}
{% endcomment %}