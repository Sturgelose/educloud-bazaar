<script src="{{ STATIC_URL }}shop/js/bower_components/jquery-ui/ui/minified/jquery-ui.min.js"></script>
<script src="{{ STATIC_URL }}shop/js/bower_components/jquery-hoverIntent/jquery.hoverIntent.js"></script>

<script type="text/javascript">

    // Animations
    //$('#content').addClass('animated fadeInDown');

    var accordionSwitchHeight = $('#accordion-switch').css('height');
    $(document).ready(function(){
        $('img.svg').each(function(){
            var $img = $(this);
            var imgID = $img.attr('id');
            var imgClass = $img.attr('class');
            var imgURL = $img.attr('src');

            $.get(imgURL, function(data) {
                // Get the SVG tag, ignore the rest
                var $svg = $(data).find('svg');

                // Add replaced image's ID to the new SVG
                if(typeof imgID !== 'undefined') {
                    $svg = $svg.attr('id', imgID);
                }
                // Add replaced image's classes to the new SVG
                if(typeof imgClass !== 'undefined') {
                    $svg = $svg.attr('class', imgClass+' replaced-svg');
                    if( imgClass.indexOf('menu-icon') > -1) {
                        $svg = $svg.click(toggleMenuItem);
                    }
                }


                // Remove any invalid XML tags as per http://validator.w3.org
                $svg = $svg.removeAttr('xmlns:a');

                // Replace image with new SVG
                $img.replaceWith($svg);

            }, 'xml');

        });

        
        if(hideExtra){
            hideExtraMenus();
        } else {
            $('#accordion-switch').click(toggleAccordion);
            toggleAccordion();
        }

        $('#language-selector .menu-icon').click(function() {
            if($(this).parent().find('.menu-box').is(":visible")) {
                $('.menu-box').hide('fade');
                $('#icons > .flexItem').removeClass('active');
            } else {
                $('.menu-box').hide('fade');
                $('#icons > .flexItem').removeClass('active');
                $(this).parent().find('.menu-box').show('fade');
            }
        });

        preparePage();
    });

    function openFilterSubitems() {
        $(this).children('ul').show('fade');    
    };
    function closeFilterSubitems() {
        $(this).children('ul').hide('fade'); 
    };
    
    function toggleMenuItem() {
        if($(this).parent().find('.menu-box').is(":visible")) {
            $('.menu-box').hide('fade');
            $('#icons > .flexItem').removeClass('active');
            $('.menu-box-content').hide();
        } else {
            $('.menu-box').hide('fade');
            $('#icons > .flexItem').removeClass('active');
            $('.menu-box-content').hide();
            $(this).parent().addClass('active');
            $(this).parent().find('.menu-box').show('slide', function() {
                $(this).parent().find('.menu-box-content').slideDown();
            });
        }
    }

    function notifyLogged(){
        var originalTransition = $('#profile-icon').css('transition');
        $('#profile-icon').css('transition','all 0 ease 0');
        $('#profile-icon').css('-webkit-transition','all 0 ease 0');
        $('#profile-icon').addClass('green', 500, 'linear', function(){
            $('#profile-icon').delay(3000).removeClass('green',2000,'linear', function(){
                $('#profile-icon').css('transition', originalTransition);
                $('#profile-icon').css('-webkit-transition', originalTransition);
            });
        });
    }


    function toggleAccordion() {
        if ($('#accordion-content').is(":visible")){
            $('#sidebarshadow').animate({'width': '50px'},300);
            $('#accordion-switch > p').show('fade');
            $('#accordion-switch').animate({'height': accordionSwitchHeight},300);
            $('.animated-button').removeClass('close');
            $('#accordion-content').hide();
        } else {
            $('#accordion-switch').css('left', '360px');
            $('#sidebarshadow').animate({'width': '400px'},300);
            $('#accordion-content').show('slide', {direction: 'right'}, 300);
            $('#accordion-switch > p').hide();
            $('#accordion-switch').animate({left: '-40px'},300);
            $('#accordion-switch').animate({'height': '40px'},300);
            $('.animated-button').addClass('close');
        }
    }
    function hideExtraMenus(){
        $('#sidebarshadow').css('width','50px');
        $('#sidebar').remove();
        $('#uppermenu').remove();
    }

    function preparePage(){


        $('#menu-subjects, #menu-grades, #menu-types, #menu-publishers').hoverIntent( openFilterSubitems, closeFilterSubitems );

        $('#tabs-product').tabs({show: 'fade'});
        $('#tabs-sidebar').tabs({show: 'fade'});

        $('#tabs-product form input').change(function(){
            calculateTotalPrice($(this).val(),$(this).parents('form').find('.totalPriceValue'))
        });

        $('.py-messages .close-btn').click(function(){
            $(this).parent().hide('fade');
        })

    }
    function calculateTotalPrice(quantity, resultSelector){
        resultSelector.text((individualPrice * quantity).toFixed(2));
    }
    

    
</script>
