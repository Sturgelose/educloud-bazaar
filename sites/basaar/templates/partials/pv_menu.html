{% load i18n %}
{% load currency_filters %}

<div id="pvmenu" class="flex-container-vertical">
    <div class="menu-header flex-container">
        <div class="menu-head-icon" style="background-image:url('{{ STATIC_URL }}shop/img/PilvivaylaLogotype_IncludingBazaar.png');"></div>
    </div>
    <div id="icons" class="flex-container-vertical">
             <a href="/catalogue">
        <div class="flexItem">
                <img class="menu-icon svg" src="{{ STATIC_URL }}shop/img/Bazaar_Home.Icon.svg"/>
        </div>
             </a>
        <div>
            <div class="menu-separator"></div>
        </div>
        <div class="flexItem" id="profile-icon">
            <img class="menu-icon svg" src="{{ STATIC_URL }}shop/img/Bazaar_Profile.Icon.svg"/>
            {% if num_unread_notifications > 0 %}
            <div class="notification-number">{{num_unread_notifications}}</div>
            {% endif %}
            <div class="menu-box">
                <div class="flex-container-vertical">
                    {% if user.is_authenticated %}
                        <div class="menu-box-header">
                            <img src="#" class="profile-pic-small">
                            Profile</div>
                        <div class="menu-box-content">
                            {% include "partials/nav_accounts.html" %}
                            <div class="menu-box-footer flex-container">
                                {% if user.is_staff or perms.partner.dashboard_access %}
                                    <a class="btn flexItem" href="{% url 'dashboard:index' %}">{% trans "Dashboard" %}</a>
                                {% endif %}
                                <a class="btn flexItem" href="{% url 'customer:summary' %}">{% trans "Account" %}</a>
                                <a class="btn flexItem" href="{% url 'customer:logout' %}">{% trans "Logout" %}</a>
                            </div>
                        </div>
                    {% else %}
                        <div class="menu-box-header">
                            Profile</div>
                        <div class="menu-box-content">
                            {% include "partials/nav_accounts.html" %}
                            <div class="menu-box-footer flex-container">
                                <a class="btn flexItem" href="{% url 'customer:login' %}">{% trans "Login or register" %}</a>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="flexItem">
            <img class="menu-icon svg" src="{{ STATIC_URL }}shop/img/Bazaar_ShoppingBasket.Icon.svg"/>
            {% if request.basket.num_lines %}
            <div class="notification-number">{{request.basket.num_lines}}</div>
            {% endif %}
            <div class="menu-box">
                <div class="flex-container-vertical">
                    <div class="menu-box-header">Basket</div>
                    <div class="menu-box-content">
                        {% include "partials/mini_basket.html" %}
                        <div class="menu-box-footer flex-container-vertical">
                            <div class="flex-container flexItem">
                                <a class="btn flexItem" href="{% url 'basket:summary' %}">{% trans "View basket" %}</a>
                                <a class="btn flexItem" href="{% url 'checkout:index' %}">{% trans "Checkout" %}</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="flexItem">
            <img class="menu-icon svg" src="{{ STATIC_URL }}shop/img/Bazaar_Search.svg"/>
            <div class="menu-box">
                <div class="menu-bridge"></div>
                <div class="flex-container-vertical">
                    <div class="menu-box-header">
                        <form id="generalSearch" method="get" action="{% url 'search:search' %}" class="flex-container">
                            <div class="flexItem">{{ search_form.q }}</div>
                            <button onclick="form.submit()">Search</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <div class="menu-separator"></div>
        </div>
    </div>
    <div class="flexItem"></div>
</div>
